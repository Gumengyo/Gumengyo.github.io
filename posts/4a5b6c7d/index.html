

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://cloud.gumengyo.top/logo.png">
  <link rel="icon" href="https://cloud.gumengyo.top/logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="顾梦">
  <meta name="keywords" content="">
  
    <meta name="description" content="大话设计模式 此文为我学习大话设计模式时的笔记，代码样例也是书里的。这本书对学习理解设计模式还是挺有帮助，推荐大家可以看看~ 第 0 章 面向对象基础 1. 类与实例 万物皆对象，对象是一个自包含的实体，用一组可识别的特性和行为来标识。 类就是具有相同的属性和功能的对象的抽象的集合。 实例，就是一个真实的对象。而实例化就是创建对象的过程，使用new关键字来创建。 2. 构造方法 构造方法，又叫构造">
<meta property="og:type" content="article">
<meta property="og:title" content="大话设计模式">
<meta property="og:url" content="https://blog.jishuqin.cn/posts/4a5b6c7d/index.html">
<meta property="og:site_name" content="Gumeng’s blog">
<meta property="og:description" content="大话设计模式 此文为我学习大话设计模式时的笔记，代码样例也是书里的。这本书对学习理解设计模式还是挺有帮助，推荐大家可以看看~ 第 0 章 面向对象基础 1. 类与实例 万物皆对象，对象是一个自包含的实体，用一组可识别的特性和行为来标识。 类就是具有相同的属性和功能的对象的抽象的集合。 实例，就是一个真实的对象。而实例化就是创建对象的过程，使用new关键字来创建。 2. 构造方法 构造方法，又叫构造">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.gumengyo.top//202305202024361.png">
<meta property="article:published_time" content="2023-05-20T20:20:00.000Z">
<meta property="article:modified_time" content="2024-08-27T02:29:39.484Z">
<meta property="article:author" content="顾梦">
<meta property="article:tag" content="设计模式">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cdn.gumengyo.top//202305202024361.png">
  
  
  
  <title>大话设计模式 - Gumeng’s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.gumengyo.top/blog/shubiao.css">
<link rel="stylesheet" href="//cdn.gumengyo.top/blog/APlayer.min.css">
<link rel="stylesheet" href="/css/twikoo.css">
<link rel="stylesheet" href="/css/font_ybwaieb31r/iconfont.css">
<link rel="stylesheet" href="/css/font_mcfotbatm2l/iconfont.css">
<link rel="stylesheet" href="//cdn1.tianli0.top/gh/zhheo/Post-Abstract-AI@0.8/tianli_gpt.css">
<link rel="stylesheet" href="/css/reward.css">
<link rel="stylesheet" href="/css/loading.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"blog.jishuqin.cn","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"✦","loop":false,"scope":["home"]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"#"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":true,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["-slim",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":6},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":true,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"hDuFZsFxs7Svak58Cr7BwZUk-gzGzoHsz","app_key":"xsTGLe4v4eXMi7H3I87RBRkL","server_url":"https://hdufzsfx.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  

<!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Gumeng’s blog" type="application/atom+xml">
</head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div>
 <!--  <script>let tianliGPT_postSelector = '#board .post-content';let tianliGPT_key = '42b2043e99bbe0dba0f8';</script>  -->
  <!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Gumeng&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

  <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
			<div class = "umami--click--Navigation-Homepage">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
			  </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-th-large"></i>
                站点
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Mainpage">
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://gumengyo.top">
                    <i class="iconfont icon-wangzhan"></i>
                    主站
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Mainpage">
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://bl.gumengyo.top">
                    <i class="iconfont icon-codepen-fill"></i>
                    博客镜像站1
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Mainpage">
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://gumengyo.github.io">
                    <i class="iconfont icon-codepen-fill"></i>
                    博客镜像站2
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Monitor">
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://kuma.gumengyo.top/status/monitor">
                    <i class="iconfont icon-codeforces"></i>
                    站点监控
                  </a>
				  </div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                文章
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Archive">
                  <a class="dropdown-item" href="/archives/">
                    <i class="iconfont icon-archive-fill"></i>
                    归档
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Category">
                  <a class="dropdown-item" href="/categories/">
                    <i class="iconfont icon-category-fill"></i>
                    分类
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Tag">
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    标签
                  </a>
				  </div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
			<div class = "umami--click--Navigation-Music">
              <a class="nav-link" href="/playlist/">
                <i class="iconfont icon-music"></i>
                音乐
              </a>
			  </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-friends"></i>
                社交
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Links">
                  <a class="dropdown-item" href="/friendLlinks/">
                    <i class="iconfont icon-link-fill"></i>
                    友链
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Rss">
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://blog.gumengyo.top/atom.xml">
                    <i class="iconfont icon-rss"></i>
                    RSS订阅
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Fcircle">
                  <a class="dropdown-item" href="/fcircle/">
                    <i class="iconfont icon-users"></i>
                    朋友圈
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Goto">
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html">
                    <i class="iconfont icon-busdaba"></i>
                    开往
                  </a>
				  </div>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
			<div class = "umami--click--Navigation-Comment">
              <a class="nav-link" href="/tellme/">
                <i class="iconfont icon-comment"></i>
                留言板
              </a>
			  </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-user-fill"></i>
                个人
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
				  <div class = "umami--click--Navigation-About">
                  <a class="dropdown-item" href="/about/">
                    <i class="iconfont icon-addrcard"></i>
                    关于
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Cloudreve">
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://cloudreve.gumengyo.top">
                    <i class="iconfont icon-briefcase"></i>
                    网盘
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-BookList">
                  <a class="dropdown-item" href="/booklist/">
                    <i class="iconfont icon-book"></i>
                    读书
                  </a>
				  </div>
                
                  
                  
                  
				  <div class = "umami--click--Navigation-Talks">
                  <a class="dropdown-item" href="/talks/">
                    <i class="iconfont icon-wechat2-fill"></i>
                    说说
                  </a>
				  </div>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('http://cdn.gumengyo.top/post.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">大话设计模式</span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        顾梦
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-05-20 20:20" pubdate>
          2023年5月20日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          55k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          460 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

<!-- HTML -->
<div id="site-loader">
  <div class="loader"></div>
  <div class="text">正在加载，请稍候...</div>
</div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem;">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">大话设计模式</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：2024年8月27日 凌晨
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h2 id="大话设计模式">大话设计模式</h2>
<p class="note note-primary">此文为我学习大话设计模式时的笔记，代码样例也是书里的。这本书对学习理解设计模式还是挺有帮助，推荐大家可以看看~</p>
<h3 id="第-0-章-面向对象基础">第 0 章 面向对象基础</h3>
<h4 id="1-类与实例">1. 类与实例</h4>
<p>万物皆对象，对象是一个自包含的实体，用一组可识别的特性和行为来标识。</p>
<p>类就是具有相同的属性和功能的对象的抽象的集合。</p>
<p>实例，就是一个真实的对象。而实例化就是创建对象的过程，使用new关键字来创建。</p>
<h4 id="2-构造方法">2. 构造方法</h4>
<p>构造方法，又叫构造函数，其实就是对类进行初始化。构造方法与类同名，无返回值，也不需要void，在 new 的使用调用。</p>
<p>所有类都有构造方法，如果你不编码则系统默认生成空的构造方法，若你有定义的构造方法，那么默认的构造方法就会失效了。</p>
<h4 id="3-方法重载">3. 方法重载</h4>
<p>方法重载提供了创建同名的多个方法的能力，但这些方法需使用不同的参数类型。</p>
<p>方法重载时，需方法名相同，但参数类型或个数必须要有所不同。</p>
<p>方法重载可在不改变原方法的基础上，新增功能。</p>
<h4 id="4-属性与修饰符">4. 属性与修饰符</h4>
<p>属性是一个方法或一对方法，即属性适合于以字段的方式使用方法调用的场合。</p>
<p>字段是存储类要满足其设计所需要的数据，字段是与类相关的变量。</p>
<h4 id="5-封装">5. 封装</h4>
<p>每个对象都包含它能进行操作所需要的所有信息，这个特性称为封装，因此对象不必依赖其他对象来完成自己的操作。</p>
<p>封装有多个好处：</p>
<ul>
<li>良好的封装能够减少耦合。</li>
<li>类内部的实现可以自由地修改。</li>
<li>类具有清晰的对外接口。</li>
</ul>
<h4 id="6-继承">6. 继承</h4>
<p>对象的继承代表了一种‘is-a’的关系，如果两个对象A和B，可以描述为‘B是A’，则表明B可以继承A。</p>
<p>继承者还可以理解为是对被继承者的特殊化，因为它除了具备被继承者的特性外，还具备自己独有的个性。</p>
<p>继承定义了类如何相互关联，共享特性。</p>
<p>继承的工作方式是：定义父类和子类，或叫作基类和派生类，其中子类继承父类的所有特性。</p>
<p>子类不但继承了父类的所有特性，还可以定义新的特性。</p>
<p>如果子类继承与父类：</p>
<ul>
<li>子类拥有父类非 private 的属性和功能</li>
<li>子类具有自己的属性和功能，即子类可以扩展父类没有的属性和功能</li>
<li>子类还可以以自己的方式实现父类的功能（方法重写）</li>
</ul>
<h3 id="第-1-章-简单工厂模式">第 1 章 简单工厂模式</h3>
<p>题目：请用C++、Java、C#或Python等任意一种面向对象语言实现一个计算器控制台程序，要去输入两个数和运算符号，得到结果。</p>
<p>​	<img src="https://cdn.gumengyo.top//image-20230424201833506.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/4/24</span><br><span class="hljs-comment"> * 简单工厂模式 实现简单计算器</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleFactory</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br><br>        System.out.println(<span class="hljs-string">&quot;请输入数字A: &quot;</span>);<br>        <span class="hljs-type">double</span> <span class="hljs-variable">numberA</span> <span class="hljs-operator">=</span> Double.parseDouble(sc.nextLine());<br>        System.out.println(<span class="hljs-string">&quot;请选择运算符号(+、-、*、/): &quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">strOperate</span> <span class="hljs-operator">=</span> sc.nextLine();<br>        System.out.println(<span class="hljs-string">&quot;请输入数字B: &quot;</span>);<br>        <span class="hljs-type">double</span> <span class="hljs-variable">numberB</span> <span class="hljs-operator">=</span> Double.parseDouble(sc.nextLine());<br><br>        <span class="hljs-type">Operation</span> <span class="hljs-variable">operate</span> <span class="hljs-operator">=</span> OperationFactory.createOperate(strOperate);<br>        <span class="hljs-type">double</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> operate.getResult(numberA, numberB);<br><br>        System.out.println(<span class="hljs-string">&quot;结果是: &quot;</span> + result);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">OperationFactory</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Operation <span class="hljs-title function_">createOperate</span><span class="hljs-params">(String operate)</span> &#123;<br>        <span class="hljs-type">Operation</span> <span class="hljs-variable">oper</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">switch</span> (operate) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;+&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Add</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;-&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sub</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;*&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mul</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;/&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Div</span>();<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> oper;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0d</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Add</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">return</span> numberA + numberB;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Sub</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">return</span> numberA + numberB;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Mul</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">return</span> numberA * numberB;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Div</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">if</span> (numberB == <span class="hljs-number">0</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;除数不能为0&quot;</span>);<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArithmeticException</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span> numberA / numberB;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="第-2-章-策略模式">第 2 章 策略模式</h3>
<p><strong>策略模式（Strategy）：它定义了算法家族，分别封装起来，让它们之间可以互相替换，此模式让算法的变化，不会影响到使用算法的客户。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230428085826966.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.*;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/4/27</span><br><span class="hljs-comment"> * 策略模式 解决商场收银问题</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StrategyPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-type">double</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>; <span class="hljs-comment">// 商品单价</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;    <span class="hljs-comment">// 商品购买数量</span><br>        <span class="hljs-type">double</span> <span class="hljs-variable">totalPrices</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>; <span class="hljs-comment">// 当前商品合计费用</span><br>        <span class="hljs-type">double</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>;  <span class="hljs-comment">// 总计所有商品费用</span><br><br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        <span class="hljs-keyword">do</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;请输入商品销售模式 1.原价 2.八折 3.满300返100&quot;</span>);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">discount</span> <span class="hljs-operator">=</span> Integer.parseInt(sc.nextLine());<br>            System.out.println(<span class="hljs-string">&quot;请输入商品单价：&quot;</span>);<br>            price = Double.parseDouble(sc.nextLine());<br>            System.out.println(<span class="hljs-string">&quot;请输入商品数量：&quot;</span>);<br>            num = Integer.parseInt(sc.nextLine());<br>            System.out.println();<br><br>            <span class="hljs-keyword">if</span> (price &gt; <span class="hljs-number">0</span> &amp;&amp; num &gt; <span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-type">CashContext</span> <span class="hljs-variable">cc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashContext</span>(discount);<br>                totalPrices = cc.getResult(price, num);<br>                total = total + totalPrices;<br><br>                System.out.println();<br>                System.out.println(<span class="hljs-string">&quot;单价：&quot;</span> + price +<span class="hljs-string">&quot;元，数量：&quot;</span> + num + <span class="hljs-string">&quot; 合计：&quot;</span> + totalPrices + <span class="hljs-string">&quot;元&quot;</span>);<br>                System.out.println();<br>                System.out.println(<span class="hljs-string">&quot;总计：&quot;</span> + total + <span class="hljs-string">&quot;元&quot;</span>);<br>                System.out.println();<br>            &#125;<br><br>        &#125;<span class="hljs-keyword">while</span> (price &gt; <span class="hljs-number">0</span> &amp;&amp; num &gt; <span class="hljs-number">0</span>);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 收费抽象类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CashSuper</span>&#123;<br><br>    <span class="hljs-comment">// 收取费用的抽象方法，参数为单价和数量</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price,<span class="hljs-type">int</span> num)</span>;<br>&#125;<br><br><span class="hljs-comment">// 正常收费</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashNormal</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CashSuper</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price, <span class="hljs-type">int</span> num)</span> &#123;<br>        <span class="hljs-keyword">return</span> price * num;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashRebate</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CashSuper</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-variable">moneyRebate</span> <span class="hljs-operator">=</span> <span class="hljs-number">1d</span>;<br><br>    <span class="hljs-comment">// 初始化时必须输入折扣率。八折就输入0.8</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CashRebate</span><span class="hljs-params">(<span class="hljs-type">double</span> moneyRebate)</span>&#123;<br>        <span class="hljs-built_in">this</span>.moneyRebate = moneyRebate;<br>    &#125;<br><br>    <span class="hljs-comment">// 计算收费时需要在原价基础上乘以折扣率</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price, <span class="hljs-type">int</span> num)</span> &#123;<br>        <span class="hljs-keyword">return</span> price * num * <span class="hljs-built_in">this</span>.moneyRebate;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashReturn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CashSuper</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-variable">moneyCondition</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>; <span class="hljs-comment">// 返利条件</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-variable">moneyReturn</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>; <span class="hljs-comment">// 返利值</span><br><br>    <span class="hljs-comment">// 返利收费。初始化时需要输入返利条件和返利值。</span><br>    <span class="hljs-comment">// 比如&quot;满300返100&quot;，就是moneyCondition=300，moneyReturn100</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CashReturn</span><span class="hljs-params">(<span class="hljs-type">double</span> moneyCondition, <span class="hljs-type">double</span> moneyReturn)</span> &#123;<br>        <span class="hljs-built_in">this</span>.moneyCondition = moneyCondition;<br>        <span class="hljs-built_in">this</span>.moneyReturn = moneyReturn;<br>    &#125;<br><br>    <span class="hljs-comment">// 计算收费时，当达到返利条件，就原价减去返利值</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price, <span class="hljs-type">int</span> num)</span> &#123;<br>        <span class="hljs-type">double</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> price * num;<br>        <span class="hljs-keyword">if</span> (moneyCondition &gt; <span class="hljs-number">0</span> &amp;&amp; price &gt;= moneyCondition)&#123;<br>            result = result - Math.floor(result / moneyCondition) * moneyReturn;<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashContext</span>&#123;<br>    <span class="hljs-keyword">private</span> CashSuper cs; <span class="hljs-comment">// 声明一个CashSuper对象</span><br><br>    <span class="hljs-comment">// 通过构造方法，传入具体的收费策略</span><br><span class="hljs-comment">//    public CashContext(CashSuper csuper)&#123;</span><br><span class="hljs-comment">//        this.cs = csuper;</span><br><span class="hljs-comment">//    &#125;</span><br><br>    <span class="hljs-comment">// 结合简单工厂模式</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CashContext</span><span class="hljs-params">(<span class="hljs-type">int</span> cashType)</span>&#123;<br>        <span class="hljs-keyword">switch</span> (cashType)&#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                <span class="hljs-built_in">this</span>.cs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashNormal</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                <span class="hljs-built_in">this</span>.cs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashRebate</span>(<span class="hljs-number">0.8d</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>                <span class="hljs-built_in">this</span>.cs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashReturn</span>(<span class="hljs-number">300d</span>,<span class="hljs-number">100d</span>);<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> price, <span class="hljs-type">int</span> num)</span> &#123;<br>        <span class="hljs-comment">// 根据收费策略的不同，获得计算结果</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.cs.acceptCash(price, num);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="第-3-章-单一职责原则">第 3 章 单一职责原则</h3>
<p><strong>单一职责原则（SRP），就一个类而言，应该仅有一个引起它变化的原因。</strong></p>
<ul>
<li>如果一个类承担的职责过多，就等于把这些职责耦合在一起，一个职责的变化可能会削弱或者抑制这个类完成其他职责的能力。这种耦合会导致脆弱的设计，当变化发生时，设计会遭受到意想不到的破坏。</li>
<li>软件设计真正要做的许多内容，就是发现职责并把那么些职责相互分离。</li>
<li>如果你能够想到多于一个的动机去改变一个类，那么这个类就是具有多于一个的职责。</li>
</ul>
<h3 id="第-4-章-开放-封闭原则">第 4 章 开放-封闭原则</h3>
<p><strong>开放-封闭原则，是说软件实体（类、模块、函数等）应该可以扩展，但是不可修改。</strong></p>
<ul>
<li>对于扩展是开放的（Open for extension)</li>
<li>对于修改是封闭的（Closed for modification）</li>
</ul>
<p><img src="https://cdn.gumengyo.top//image-20230428090233389.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>开放-封闭原则是面向对象设计的核心所在。遵循这个原则可以带来面向对象技术所声称的巨大好处，也就是可维护、可扩展、可复用、灵活性好。</p>
<h3 id="第-5-章-依赖倒转原则">第 5 章 依赖倒转原则</h3>
<p>依赖倒转原则：</p>
<ul>
<li>高层模块不应该依赖低层模块。两个都应该依赖抽象。</li>
<li>抽象不应该依赖细节。细节应该依赖抽象。</li>
</ul>
<p>里氏代换原则（LSP）：子类型必须能够替换掉它们的父类型。</p>
<p>由于子类型的可替换性才使得使用父类类型的模块在无须修改的情况下就可以扩展。</p>
<p><img src="https://cdn.gumengyo.top//image-20230428092805695.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="第-6-章-装饰模式">第 6 章 装饰模式</h3>
<p><strong>装饰模式（Decorator），动态地给一个对象添加一些额外的职责，就增加功能来说，装饰模式比生成子类更为灵活。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230428141827346.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/4/28</span><br><span class="hljs-comment"> * 装饰模式</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DecoratorPattern</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ConcreteComponent</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteComponent</span>();<br>        <span class="hljs-type">ConcreteDecoratorA</span> <span class="hljs-variable">d1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteDecoratorA</span>();<br>        <span class="hljs-type">ConcreteDecoratorB</span> <span class="hljs-variable">d2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteDecoratorB</span>();<br><br>        d1.SetComponent(c); <span class="hljs-comment">// 首先用d1来包装c</span><br>        d2.SetComponent(d1); <span class="hljs-comment">// 再用d2来包装d1</span><br>        d2.Operation(); <span class="hljs-comment">// 最终执行d2的Operation()</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Operation</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Operation</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;具体对象的实际操作&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Decorator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span>&#123;<br>    <span class="hljs-keyword">protected</span> Component component;<br><br>    <span class="hljs-comment">// 装饰一个Component 对象</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">SetComponent</span><span class="hljs-params">(Component component)</span>&#123;<br>        <span class="hljs-built_in">this</span>.component = component;<br>    &#125;<br><br>    <span class="hljs-comment">// 重写Operation()，实际调用component的Operation方法</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Operation</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (component != <span class="hljs-literal">null</span>)&#123;<br>            component.Operation();;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteDecoratorA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Decorator</span>&#123;<br><br>    <span class="hljs-keyword">protected</span> String addedState; <span class="hljs-comment">// 本类独有字字段，以区别于ConcreteDecoratorB类</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Operation</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-built_in">super</span>.Operation();  <span class="hljs-comment">// 首先运行了原有Component的Operation()</span><br><br>        <span class="hljs-built_in">this</span>.addedState = <span class="hljs-string">&quot;具有装饰对象A的独有操作&quot;</span>; <span class="hljs-comment">// 再执行本类独有的功能</span><br>        System.out.println(<span class="hljs-built_in">this</span>.addedState);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteDecoratorB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Decorator</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Operation</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-built_in">super</span>.Operation(); <span class="hljs-comment">// 首先运行了原有Component的Operation()</span><br>        <span class="hljs-built_in">this</span>.AddedBehavior(); <span class="hljs-comment">// 再执行本类独有功能</span><br>    &#125;<br><br>    <span class="hljs-comment">// 本类独有方法，以区别于ConcreteDecoratorA类</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">AddedBehavior</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;具有装饰对象B的独有操作&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>商场促销——简单工厂+策略+装饰模式实现</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230428141722534.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuin;<br><br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/4/28</span><br><span class="hljs-comment"> * 商场促销——简单工厂+策略+装饰模式</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Promotion</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;**********************************************&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;《大话设计模式》代码样例&quot;</span>);<br>        System.out.println();<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">discount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;         <span class="hljs-comment">//商品折扣模式</span><br>        <span class="hljs-type">double</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>;         <span class="hljs-comment">//商品单价</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;            <span class="hljs-comment">//商品购买数量</span><br>        <span class="hljs-type">double</span> <span class="hljs-variable">totalPrices</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>;<span class="hljs-comment">//当前商品合计费用</span><br>        <span class="hljs-type">double</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>;        <span class="hljs-comment">//总计所有商品费用</span><br><br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br><br>        <span class="hljs-keyword">do</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;商品折扣模式如下:&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;1.正常收费&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;2.打八折&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;3.打七折&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;4.满300送100&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;5.先打8折，再满300送100&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;6.先满200送50，再打7折&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;请输入商品折扣模式:&quot;</span>);<br>            discount = Integer.parseInt(sc.nextLine());<br>            System.out.println(<span class="hljs-string">&quot;请输入商品单价：&quot;</span>);<br>            price = Double.parseDouble(sc.nextLine());<br>            System.out.println(<span class="hljs-string">&quot;请输入商品数量：&quot;</span>);<br>            num = Integer.parseInt(sc.nextLine());<br>            System.out.println();<br><br>            <span class="hljs-keyword">if</span> (price&gt;<span class="hljs-number">0</span> &amp;&amp; num&gt;<span class="hljs-number">0</span>)&#123;<br><br>                <span class="hljs-comment">//根据用户输入，将对应的策略对象作为参数传入CashContext对象中</span><br>                <span class="hljs-type">CashContext</span> <span class="hljs-variable">cc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashContext</span>(discount);<br><br>                <span class="hljs-comment">//通过Context的getResult方法的调用，可以得到收取费用的结果</span><br>                <span class="hljs-comment">//让具体算法与客户进行了隔离</span><br>                totalPrices = cc.getResult(price,num);<br><br>                total = total + totalPrices;<br><br>                System.out.println();<br>                System.out.println(<span class="hljs-string">&quot;单价：&quot;</span>+ price + <span class="hljs-string">&quot;元 数量：&quot;</span>+ num +<span class="hljs-string">&quot; 合计：&quot;</span>+ totalPrices +<span class="hljs-string">&quot;元&quot;</span>);<br>                System.out.println();<br>                System.out.println(<span class="hljs-string">&quot;总计：&quot;</span>+ total+<span class="hljs-string">&quot;元&quot;</span>);<br>                System.out.println();<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">while</span>(price&gt;<span class="hljs-number">0</span> &amp;&amp; num&gt;<span class="hljs-number">0</span>);<br><br>        System.out.println();<br>        System.out.println(<span class="hljs-string">&quot;**********************************************&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ISale</span> &#123;<br>    <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price,<span class="hljs-type">int</span> num)</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashSuper</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ISale</span> &#123;<br><br>    <span class="hljs-keyword">protected</span> ISale component;<br><br>    <span class="hljs-comment">//装饰对象</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decorate</span><span class="hljs-params">(ISale component)</span> &#123;<br>        <span class="hljs-built_in">this</span>.component=component;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price,<span class="hljs-type">int</span> num)</span>&#123;<br><br>        <span class="hljs-type">double</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.component != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-comment">//若装饰对象存在，则执行装饰的算法运算</span><br>            result = <span class="hljs-built_in">this</span>.component.acceptCash(price,num);<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br><br>    &#125;<br><br>&#125;<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashNormal</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ISale</span> &#123;<br>    <span class="hljs-comment">//正常收费，原价返回</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price,<span class="hljs-type">int</span> num)</span>&#123;<br>        <span class="hljs-keyword">return</span> price * num;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashRebate</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CashSuper</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-variable">moneyRebate</span> <span class="hljs-operator">=</span> <span class="hljs-number">1d</span>;<br>    <span class="hljs-comment">//打折收费。初始化时必需输入折扣率。八折就输入0.8</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CashRebate</span><span class="hljs-params">(<span class="hljs-type">double</span> moneyRebate)</span>&#123;<br>        <span class="hljs-built_in">this</span>.moneyRebate = moneyRebate;<br>    &#125;<br><br>    <span class="hljs-comment">//计算收费时需要在原价基础上乘以折扣率</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price,<span class="hljs-type">int</span> num)</span>&#123;<br>        <span class="hljs-type">double</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> price * num * <span class="hljs-built_in">this</span>.moneyRebate;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.acceptCash(result,<span class="hljs-number">1</span>);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashReturn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CashSuper</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-variable">moneyCondition</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>; <span class="hljs-comment">//返利条件</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-variable">moneyReturn</span> <span class="hljs-operator">=</span> <span class="hljs-number">0d</span>;    <span class="hljs-comment">//返利值</span><br><br>    <span class="hljs-comment">//返利收费。初始化时需要输入返利条件和返利值。</span><br>    <span class="hljs-comment">//比如“满300返100”，就是moneyCondition=300,moneyReturn=100</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CashReturn</span><span class="hljs-params">(<span class="hljs-type">double</span> moneyCondition,<span class="hljs-type">double</span> moneyReturn)</span>&#123;<br>        <span class="hljs-built_in">this</span>.moneyCondition = moneyCondition;<br>        <span class="hljs-built_in">this</span>.moneyReturn = moneyReturn;<br>    &#125;<br><br>    <span class="hljs-comment">//计算收费时，当达到返利条件，就原价减去返利值</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">acceptCash</span><span class="hljs-params">(<span class="hljs-type">double</span> price,<span class="hljs-type">int</span> num)</span>&#123;<br>        <span class="hljs-type">double</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> price * num;<br>        <span class="hljs-keyword">if</span> (moneyCondition&gt;<span class="hljs-number">0</span> &amp;&amp; result &gt;= moneyCondition)<br>            result = result - Math.floor(result / moneyCondition) * moneyReturn;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.acceptCash(result,<span class="hljs-number">1</span>);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CashContext</span> &#123;<br>    <span class="hljs-keyword">private</span> ISale cs;   <span class="hljs-comment">//声明一个ISale接口对象</span><br><br>    <span class="hljs-comment">//通过构造方法，传入具体的收费策略</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CashContext</span><span class="hljs-params">(<span class="hljs-type">int</span> cashType)</span> &#123;<br>        <span class="hljs-keyword">switch</span> (cashType) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                <span class="hljs-built_in">this</span>.cs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashNormal</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                <span class="hljs-type">CashRebate</span> <span class="hljs-variable">cr1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashRebate</span>(<span class="hljs-number">0.7d</span>);<br>                cr1.decorate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CashNormal</span>());<br>                <span class="hljs-built_in">this</span>.cs = cr1;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>                <span class="hljs-type">CashRebate</span> <span class="hljs-variable">cr2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashRebate</span>(<span class="hljs-number">0.8d</span>);<br>                cr2.decorate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CashNormal</span>());<br>                <span class="hljs-built_in">this</span>.cs = cr2;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>                <span class="hljs-type">CashReturn</span> <span class="hljs-variable">cr3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashReturn</span>(<span class="hljs-number">300d</span>, <span class="hljs-number">100d</span>);<br>                cr3.decorate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CashNormal</span>());<br>                <span class="hljs-built_in">this</span>.cs = cr3;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>                <span class="hljs-comment">//先打8折,再满300返100</span><br>                <span class="hljs-type">CashNormal</span> <span class="hljs-variable">cn</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashNormal</span>();<br>                <span class="hljs-type">CashReturn</span> <span class="hljs-variable">cr4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashReturn</span>(<span class="hljs-number">300d</span>, <span class="hljs-number">100d</span>);<br>                <span class="hljs-type">CashRebate</span> <span class="hljs-variable">cr5</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashRebate</span>(<span class="hljs-number">0.8d</span>);<br>                cr4.decorate(cn);   <span class="hljs-comment">//用满300返100算法包装基本的原价算法</span><br>                cr5.decorate(cr4);  <span class="hljs-comment">//打8折算法装饰满300返100算法</span><br>                <span class="hljs-built_in">this</span>.cs = cr5;      <span class="hljs-comment">//将包装好的算法组合引用传递给cs对象</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<br>                <span class="hljs-comment">//先满200返50，再打7折</span><br>                <span class="hljs-type">CashNormal</span> <span class="hljs-variable">cn2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashNormal</span>();<br>                <span class="hljs-type">CashRebate</span> <span class="hljs-variable">cr6</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashRebate</span>(<span class="hljs-number">0.7d</span>);<br>                <span class="hljs-type">CashReturn</span> <span class="hljs-variable">cr7</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashReturn</span>(<span class="hljs-number">200d</span>, <span class="hljs-number">50d</span>);<br>                cr6.decorate(cn2);  <span class="hljs-comment">//用打7折算法包装基本的原价算法</span><br>                cr7.decorate(cr6);  <span class="hljs-comment">//满200返50算法装饰打7折算法</span><br>                <span class="hljs-built_in">this</span>.cs = cr7;      <span class="hljs-comment">//将包装好的算法组合引用传递给cs对象</span><br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> price,<span class="hljs-type">int</span> num)</span>&#123;<br>        <span class="hljs-comment">//根据收费策略的不同，获得计算结果</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.cs.acceptCash(price,num);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="第-7-章-代理模式">第 7 章 代理模式</h3>
<p><strong>代理模式（Proxy），为其他对象提供一种代理以控制对这个对象的访问。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230503180154059.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/4/27</span><br><span class="hljs-comment"> * 代理模式——为别人做嫁衣</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxyPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">SchoolGirl</span> <span class="hljs-variable">girlLjj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SchoolGirl</span>();<br>        girlLjj.setName(<span class="hljs-string">&quot;李娇娇&quot;</span>);<br><br>        <span class="hljs-type">Proxy</span> <span class="hljs-variable">boyDl</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(girlLjj);<br>        boyDl.giveDolls();<br>        boyDl.giveFlowers();<br>        boyDl.giveChocolate();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IGiveGift</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveDolls</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveFlowers</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveChocolate</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">// 被追求者类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SchoolGirl</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 追求者类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Pursuit</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IGiveGift</span>&#123;<br><br>    <span class="hljs-keyword">private</span> SchoolGirl mm;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Pursuit</span><span class="hljs-params">(SchoolGirl mm)</span>&#123;<br>        <span class="hljs-built_in">this</span>.mm = mm;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveDolls</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.mm.getName() + <span class="hljs-string">&quot;,你好！送你洋娃娃。&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveFlowers</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.mm.getName() + <span class="hljs-string">&quot;,你好！送你鲜花。&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveChocolate</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.mm.getName() + <span class="hljs-string">&quot;,你好！送你巧克力。&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 代理类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Proxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IGiveGift</span>&#123;<br><br>    <span class="hljs-keyword">private</span> Pursuit gg;     <span class="hljs-comment">// 认识追求者</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Proxy</span><span class="hljs-params">(SchoolGirl mm)</span>&#123;<br>        <span class="hljs-built_in">this</span>.gg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pursuit</span>(mm);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveDolls</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.gg.giveDolls();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveFlowers</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.gg.giveFlowers();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveChocolate</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.gg.giveChocolate();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>代理模式应用</strong>：</p>
<ul>
<li>远程代理，也就是为一个对象在不同的地址空间提供局部代表。这样可以隐藏一个对象存在于不同地址空间的事实。</li>
<li>虚拟代理，是根据需要创建开销很大的对象。通过它来存放实例化需要很长时间的真实对象。</li>
<li>安全代理，用来控制真实对象访问的权限。</li>
<li>智能指引，是指当调用真实的对象时，代理处理另外一些事。</li>
</ul>
<h3 id="第-8-章-工厂方法模式">第 8 章 工厂方法模式</h3>
<p><strong>工厂方法模式（Factory Method），定义一个用于创建对象的接口，让子类决定实例化哪一个类。工厂方法使一个类的实例化延迟到其子类。</strong></p>
<p>工厂方法模式是简单工厂模式的进一步抽象和推广。</p>
<p>优点：</p>
<ul>
<li>对于复杂的参数构造对象，可以很好地对外层屏蔽代码的复杂性</li>
<li>很好的解耦能力</li>
</ul>
<p><img src="https://cdn.gumengyo.top/Snipaste_2023-05-04_09-20-36.png" srcset="/img/loading.gif" lazyload alt=""><br>
<img src="https://cdn.gumengyo.top/Snipaste_2023-05-04_11-22-06.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter08;<br><br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FactoryMethod</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br><br>        System.out.println(<span class="hljs-string">&quot;请输入数字A: &quot;</span>);<br>        <span class="hljs-type">double</span> <span class="hljs-variable">numberA</span> <span class="hljs-operator">=</span> Double.parseDouble(sc.nextLine());<br>        System.out.println(<span class="hljs-string">&quot;请选择运算符号(+、-、*、/、pow、log): &quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">strOperate</span> <span class="hljs-operator">=</span> sc.nextLine();<br>        System.out.println(<span class="hljs-string">&quot;请输入数字B: &quot;</span>);<br>        <span class="hljs-type">double</span> <span class="hljs-variable">numberB</span> <span class="hljs-operator">=</span> Double.parseDouble(sc.nextLine());<br><br>        <span class="hljs-type">Operation</span> <span class="hljs-variable">operate</span> <span class="hljs-operator">=</span> OperationFactory.createOperate(strOperate);<br>        <span class="hljs-type">double</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> operate.getResult(numberA, numberB);<br><br>        System.out.println(<span class="hljs-string">&quot;结果是: &quot;</span> + result);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> ;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Add</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">return</span> numberA + numberB;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Sub</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">return</span> numberA + numberB;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Mul</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">return</span> numberA * numberB;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Div</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-keyword">if</span> (numberB == <span class="hljs-number">0</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;除数不能为0&quot;</span>);<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArithmeticException</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span> numberA / numberB;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 指数运算类，求numberA的numberB次方</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Pow</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-comment">// 此处缺两参数的有效性检测</span><br>        <span class="hljs-keyword">return</span> Math.pow(numberA,numberB);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 对数运算类，求以numberA为底的numberB的对数</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Log</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Operation</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getResult</span><span class="hljs-params">(<span class="hljs-type">double</span> numberA, <span class="hljs-type">double</span> numberB)</span> &#123;<br>        <span class="hljs-comment">// 此处缺两参数的有效性检测</span><br>        <span class="hljs-keyword">return</span> Math.log(numberB) / Math.log(numberA);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IFactory</span>&#123;<br>    Operation <span class="hljs-title function_">createOperation</span><span class="hljs-params">(String operType)</span>;<br>&#125;<br><br><span class="hljs-comment">// 基础运算工厂</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FactoryBasic</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IFactory</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Operation <span class="hljs-title function_">createOperation</span><span class="hljs-params">(String operType)</span> &#123;<br>        <span class="hljs-type">Operation</span> <span class="hljs-variable">oper</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">switch</span> (operType)&#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;+&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Add</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;-&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sub</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;*&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mul</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;/&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Div</span>();<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> oper;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 高级运算工厂</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FactoryAdvanced</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IFactory</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Operation <span class="hljs-title function_">createOperation</span><span class="hljs-params">(String operType)</span> &#123;<br>        <span class="hljs-type">Operation</span> <span class="hljs-variable">oper</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">switch</span> (operType)&#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;pow&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pow</span>(); <span class="hljs-comment">// 指数运算类实例</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;log&quot;</span>:<br>                oper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Log</span>(); <span class="hljs-comment">// 对数运算类实例</span><br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-comment">// 此处可扩展其他高级运算类的实例化，可修改</span><br>            <span class="hljs-comment">// 当前工厂类不会影响到基础运算工厂类</span><br><br>        &#125;<br>        <span class="hljs-keyword">return</span> oper;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">OperationFactory</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Operation <span class="hljs-title function_">createOperate</span><span class="hljs-params">(String operate)</span>&#123;<br>        <span class="hljs-type">Operation</span> <span class="hljs-variable">oper</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">IFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">switch</span> (operate)&#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;+&quot;</span>:<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;-&quot;</span>:<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;*&quot;</span>:<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;/&quot;</span>:<br>                <span class="hljs-comment">// 基础运算工厂实例</span><br>                factory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FactoryBasic</span>();<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;pow&quot;</span>:<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;log&quot;</span>:<br>                <span class="hljs-comment">// 高级运算工厂实例</span><br>                factory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FactoryAdvanced</span>();<br>        &#125;<br>        <span class="hljs-comment">// 利用多态返回实际的运算类实例</span><br>        oper = factory.createOperation(operate);<br>        <span class="hljs-keyword">return</span> oper;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="第-9-章-原型模式">第 9 章 原型模式</h3>
<p><strong>原型模式（Prototype），用原型实例指定创建对象的种类，并且通过复制这些原型创建新的对象。</strong></p>
<p>原型模式其实就是从一个对象再创建另外一个可定制的对象，而且不需要知道任何创建的细节。</p>
<p><strong>浅复制与深复制：</strong></p>
<ul>
<li>浅复制：被复制对象的所有变量都含有与原来的对象相同的值，而所有的对其他对象的引用都仍然指向原来的对象。</li>
<li>深复制：深复制把引用对象的变量指向复制过的新对象，而不是原有的被引用的对象。</li>
</ul>
<p><img src="https://cdn.gumengyo.top/Snipaste_2023-05-04_11-21-15.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter09;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/5/4</span><br><span class="hljs-comment"> * 简历复印——原型模式</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrototypePattern</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Resume</span> <span class="hljs-variable">resume1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Resume</span>(<span class="hljs-string">&quot;大鸟&quot;</span>);<br>        resume1.setPersonalInfo(<span class="hljs-string">&quot;男&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>);<br>        resume1.setWorkExperience(<span class="hljs-string">&quot;1998-2000&quot;</span>,<span class="hljs-string">&quot;xx公司&quot;</span>);<br><br>        <span class="hljs-type">Resume</span> <span class="hljs-variable">resume2</span> <span class="hljs-operator">=</span> resume1.clone();<br>        resume2.setWorkExperience(<span class="hljs-string">&quot;2000-2003&quot;</span>,<span class="hljs-string">&quot;YY集团&quot;</span>);<br><br>        <span class="hljs-type">Resume</span> <span class="hljs-variable">resume3</span> <span class="hljs-operator">=</span> resume1.clone();<br>        resume3.setPersonalInfo(<span class="hljs-string">&quot;男&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>);<br><br>        resume1.display();<br>        resume2.display();<br>        resume3.display();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 工作经历类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkExperience</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Cloneable</span>&#123;<br>    <span class="hljs-comment">// 工作时间范围</span><br>    <span class="hljs-keyword">private</span> String timeArea;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getTimeArea</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> timeArea;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setTimeArea</span><span class="hljs-params">(String timeArea)</span> &#123;<br>        <span class="hljs-built_in">this</span>.timeArea = timeArea;<br>    &#125;<br><br>    <span class="hljs-comment">// 所在公司</span><br>    <span class="hljs-keyword">private</span> String company;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getCompany</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> company;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCompany</span><span class="hljs-params">(String company)</span> &#123;<br>        <span class="hljs-built_in">this</span>.company = company;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> WorkExperience <span class="hljs-title function_">clone</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">WorkExperience</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span>&#123;<br>            object = (WorkExperience) <span class="hljs-built_in">super</span>.clone();<br>        &#125;<span class="hljs-keyword">catch</span> (CloneNotSupportedException exception)&#123;<br>            System.out.println(<span class="hljs-string">&quot;Clone异常。&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> object;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 简历类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Resume</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Cloneable</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> String sex;<br>    <span class="hljs-keyword">private</span> String age;<br>    <span class="hljs-keyword">private</span> WorkExperience work;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Resume</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.work = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WorkExperience</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 设置个人信息</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPersonalInfo</span><span class="hljs-params">(String sex,String age)</span>&#123;<br>        <span class="hljs-built_in">this</span>.sex = sex;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-comment">// 设置工作经历</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setWorkExperience</span><span class="hljs-params">(String timeArea,String company)</span>&#123;<br>        <span class="hljs-built_in">this</span>.work.setTimeArea(timeArea);    <span class="hljs-comment">// 给工作经历实例的时间范围赋值</span><br>        <span class="hljs-built_in">this</span>.work.setCompany(company);      <span class="hljs-comment">// 给工作经历实例的公司赋值</span><br>    &#125;<br><br>    <span class="hljs-comment">// 展示简历</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; &quot;</span> + <span class="hljs-built_in">this</span>.sex + <span class="hljs-string">&quot; &quot;</span> + <span class="hljs-built_in">this</span>.age);<br>        System.out.println(<span class="hljs-string">&quot;工作经历 &quot;</span> + <span class="hljs-built_in">this</span>.work.getTimeArea() + <span class="hljs-string">&quot; &quot;</span> + <span class="hljs-built_in">this</span>.work.getCompany());<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Resume <span class="hljs-title function_">clone</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Resume</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            object = (Resume) <span class="hljs-built_in">super</span>.clone();<br>            object.work = <span class="hljs-built_in">this</span>.work.clone(); <span class="hljs-comment">// 深复制</span><br>        &#125;<span class="hljs-keyword">catch</span> (CloneNotSupportedException exception)&#123;<br>            System.out.println(<span class="hljs-string">&quot;Clone 异常。&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> object;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h3 id="第-10-章-模板方法模式">第 10 章 模板方法模式</h3>
<p><strong>模板方法（Template Method）模式，定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。模板方法使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230504142740007.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter10;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TemplateMethod</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">AbstractClass</span> <span class="hljs-variable">abstractClass</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteClassA</span>();<br>        abstractClass.templateMethod();<br><br>        abstractClass = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteClassB</span>();<br>        abstractClass.templateMethod();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 模板方法抽象类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractClass</span>&#123;<br>    <span class="hljs-comment">// 模板方法</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">templateMethod</span><span class="hljs-params">()</span>&#123;<br><br>        <span class="hljs-comment">// 写一些可以被子类共享的代码</span><br>        System.out.println(<span class="hljs-string">&quot;共享的代码~&quot;</span>);<br><br>        <span class="hljs-built_in">this</span>.primitiveOperation1();<br>        <span class="hljs-built_in">this</span>.primitiveOperation2();<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">primitiveOperation1</span><span class="hljs-params">()</span>; <span class="hljs-comment">// 子类个性的行为，放到子类去实现</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">primitiveOperation2</span><span class="hljs-params">()</span>; <span class="hljs-comment">// 子类个性的行为，放到子类去实现</span><br>&#125;<br><br><span class="hljs-comment">// 模板方法具体类A</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteClassA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractClass</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">primitiveOperation1</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;具体类A方法1实现&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">primitiveOperation2</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;具体类A方法2实现&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 模板方法具体类B</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteClassB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractClass</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">primitiveOperation1</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;具体类B方法1实现&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">primitiveOperation2</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;具体类B方法2实现&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>模板方法模式的特点</strong></p>
<ul>
<li>模板方法模式是通过把不变行为搬移到超类，去除子类中的重复代码来体现它的优势。</li>
<li>模板方法模式就是提供了一个很好的代码复用平台。</li>
</ul>
<h3 id="第-11-章-迪米特法则">第 11 章 迪米特法则</h3>
<p>迪米特法则（LoD），也叫最少知识原则。<br>
<strong>迪米特法则（LoD）：如果两个类不必彼此直接通信，那么这两个类就不应当发生直接的相互作用。如果其中一个类需要调用另一个类的某一个方法的话，可以通过第三者转发这个调用。</strong></p>
<h3 id="第-12-章-外观模式">第 12 章 外观模式</h3>
<p><strong>外观模式（Facade），为子系统中的一组接口提供一个一致的界面，此模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230505171033965.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter11;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/5/5</span><br><span class="hljs-comment"> * 外观模式</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FacadePattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Facade</span> <span class="hljs-variable">facade</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Facade</span>();<br><br>        facade.methodA();<br>        facade.methodB();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 子系统1</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubSystemOne</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodOne</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;子系统方法一&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 子系统2</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubSystemTwo</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodTwo</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;子系统方法二&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 子系统3</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubSystemThree</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodThree</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;子系统方法三&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 子系统1</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubSystemFour</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodFour</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;子系统方法四&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 外观类</span><br><span class="hljs-comment">// 它需要了解所有子系统的方法或属性，进行组合以被外界调用</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Facade</span>&#123;<br>    SubSystemOne one;<br>    SubSystemTwo two;<br>    SubSystemThree three;<br>    SubSystemFour four;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Facade</span><span class="hljs-params">()</span>&#123;<br>        one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubSystemOne</span>();<br>        two = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubSystemTwo</span>();<br>        three = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubSystemThree</span>();<br>        four = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubSystemFour</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodA</span><span class="hljs-params">()</span>&#123;<br>        one.methodOne();<br>        two.methodTwo();<br>        three.methodThree();<br>        four.methodFour();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodB</span><span class="hljs-params">()</span>&#123;<br>        two.methodTwo();<br>        three.methodThree();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="第-13-章-建造者模式">第 13 章 建造者模式</h3>
<p><strong>建造者模式（Builder），将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230505194106302.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter13;<br><br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/5/5</span><br><span class="hljs-comment"> * 建造者模式</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BuilderPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Director</span> <span class="hljs-variable">director</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Director</span>();<br>        <span class="hljs-type">Builder</span> <span class="hljs-variable">b1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteBuilder1</span>();<br>        <span class="hljs-type">Builder</span> <span class="hljs-variable">b2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteBuilder2</span>();<br><br>        <span class="hljs-comment">// 指挥者用ConcreteBuilder1的方法来建造产品</span><br>        director.construct(b1); <span class="hljs-comment">// 创建的是产品A和产品B</span><br>        <span class="hljs-type">Product</span> <span class="hljs-variable">p1</span> <span class="hljs-operator">=</span> b1.getResult();<br>        p1.show();<br><br>        <span class="hljs-comment">// 指挥者用ConcreteBuilder2的方法来建造产品</span><br>        director.construct(b2); <span class="hljs-comment">// 创建的是产品X和产品Y</span><br>        <span class="hljs-type">Product</span> <span class="hljs-variable">p2</span> <span class="hljs-operator">=</span> b2.getResult();<br>        p2.show();<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 产品类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> &#123;<br>    ArrayList&lt;String&gt; parts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();<br><br>    <span class="hljs-comment">// 添加新的产品部件</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(String part)</span>&#123;<br>        parts.add(part);<br>    &#125;<br><br>    <span class="hljs-comment">// 列举所有产品部件</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">for</span> (String part : parts) &#123;<br>            System.out.println(part);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 抽象的建造者类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">buildPartA</span><span class="hljs-params">()</span>; <span class="hljs-comment">// 建造部件A</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">buildPartB</span><span class="hljs-params">()</span>; <span class="hljs-comment">// 建造部件B</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Product <span class="hljs-title function_">getResult</span><span class="hljs-params">()</span>; <span class="hljs-comment">// 得到产品</span><br>&#125;<br><br><span class="hljs-comment">// 具体建造者1</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteBuilder1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Builder</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">buildPartA</span><span class="hljs-params">()</span> &#123;<br>        product.add(<span class="hljs-string">&quot;部件A&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">buildPartB</span><span class="hljs-params">()</span> &#123;<br>        product.add(<span class="hljs-string">&quot;部件B&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getResult</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> product;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 具体建造者2</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteBuilder2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Builder</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">buildPartA</span><span class="hljs-params">()</span> &#123;<br>        product.add(<span class="hljs-string">&quot;部件X&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">buildPartB</span><span class="hljs-params">()</span> &#123;<br>        product.add(<span class="hljs-string">&quot;部件Y&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getResult</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> product;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 指挥者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Director</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">construct</span><span class="hljs-params">(Builder builder)</span> &#123;<br>        builder.buildPartA();<br>        builder.buildPartB();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>建造者模式的好处就是使得建造代码与表示代码分离，由于建造者隐藏了该产品是如何组装的，所以若需要改变一个产品的内部表示，只需要再定义一个具体的建造者就可以了。</p>
<p>建造者模式是在当创建复杂对象的算法应该独立于该对象的组成部分以及它们的装配方式时适用的模式。</p>
<h3 id="第-14-章-观察者模式">第 14 章 观察者模式</h3>
<p>观察者模式又叫作发布-订阅（Publish/Subscri）模式。</p>
<p><strong>观察者模式定义了一种一对多的依赖关系，让多个观察者对象同时监听某一个主题对象。这个主题对象在状态发生变化时，会通知所有观察者对象，使它们能够自动更新自己。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230506133700094.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter14;<br><br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/5/6</span><br><span class="hljs-comment"> * 观察者模式</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ObserverPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Subject</span> <span class="hljs-variable">subject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteSubject</span>();<br>        subject.attach(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteObserver</span>(<span class="hljs-string">&quot;NameX&quot;</span>,subject));<br>        subject.attach(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteObserver</span>(<span class="hljs-string">&quot;NameY&quot;</span>,subject));<br>        subject.attach(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteObserver</span>(<span class="hljs-string">&quot;NameZ&quot;</span>, subject));<br>        subject.setSubjectState(<span class="hljs-string">&quot;ABC&quot;</span>);<br><br>        subject.notifyObserver();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 通知者抽象类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Subject</span> &#123;<br>    <span class="hljs-keyword">private</span> ArrayList&lt;Observer&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Observer&gt;(); <span class="hljs-comment">// 针对抽象的Observer编程</span><br><br>    <span class="hljs-comment">// 增加观察者</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attach</span><span class="hljs-params">(Observer observer)</span>&#123;<br>        list.add(observer);<br>    &#125;<br><br>    <span class="hljs-comment">// 减少观察者</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detach</span><span class="hljs-params">(Observer observer)</span>&#123;<br>        list.remove(observer);<br>    &#125;<br><br>    <span class="hljs-comment">// 通知观察者</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObserver</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">for</span> (Observer item : list) &#123;<br>            item.update();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> String subjectState;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getSubjectState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.subjectState;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSubjectState</span><span class="hljs-params">(String value)</span> &#123;<br>        <span class="hljs-built_in">this</span>.subjectState = value;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 抽象观察者</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">// 具体通知者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteSubject</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Subject</span>&#123;<br>    <span class="hljs-comment">// 具体通知者的方法</span><br>&#125;<br><br><span class="hljs-comment">// 具体观察者类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteObserver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Observer</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Subject  sub;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConcreteObserver</span><span class="hljs-params">(String name,Subject sub)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.sub = sub;<br>    &#125;<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;观察者&quot;</span>+<span class="hljs-built_in">this</span>.name+<span class="hljs-string">&quot;的新状态是&quot;</span>+<span class="hljs-built_in">this</span>.sub.getSubjectState());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>特点：</strong></p>
<ul>
<li>当一个对象的改变需要同时改变其他对象，而且它不知道具体有多少对象有待改变时，应该考虑使用观察者模式。</li>
<li>抽象模型有两个方面，其中一方面依赖于另一方面，这时用观察者模式可以将这两者封装在独立的对象中使它们各自独立地改变和复用。</li>
<li>观察者模式所做的工作其实就是在解除耦合。让耦合的双方都依赖于抽象，而不是依赖于具体。从而使得各自的变化都不会影响另一边的变化。</li>
</ul>
<h3 id="第-15-章-抽象工厂模式">第 15 章 抽象工厂模式</h3>
<p><strong>抽象工厂模式（Abstract Factory），提供一个创建一系列相关或相互依赖对象的接口，而无须指定它们具体的类。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter15;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> 顾梦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2023/5/6</span><br><span class="hljs-comment"> * 抽象工厂模式</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractFactory</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        <span class="hljs-type">Department</span> <span class="hljs-variable">department</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Department</span>();<br><br>        <span class="hljs-type">IFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlserverFactory</span>();<br><br>        <span class="hljs-type">IUser</span> <span class="hljs-variable">iu</span> <span class="hljs-operator">=</span> factory.createUser();<br>        iu.insert(user);        <span class="hljs-comment">// 新增一个用户</span><br>        iu.getUser(<span class="hljs-number">1</span>);      <span class="hljs-comment">//得到用户ID为1的用户信息</span><br><br>        <span class="hljs-type">IDepartment</span> <span class="hljs-variable">idept</span> <span class="hljs-operator">=</span> factory.createDepartment();<br>        idept.insert(department);<br>        idept.getDepartment(<span class="hljs-number">2</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 用户类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>&#123;<br><br>    <span class="hljs-comment">// 用户ID</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> _id;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._id;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> &#123;<br>        <span class="hljs-built_in">this</span>._id = value;<br>    &#125;<br><br>    <span class="hljs-comment">// 用户姓名</span><br>    <span class="hljs-keyword">private</span> String _name;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String value)</span>&#123;<br>        <span class="hljs-built_in">this</span>._name = value;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 部门类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Department</span>&#123;<br><br>    <span class="hljs-comment">// 部门ID</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> _id;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">get_id</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._id;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">set_id</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span>&#123;<br>        <span class="hljs-built_in">this</span>._id = value;<br>    &#125;<br><br>    <span class="hljs-comment">// 部门名称</span><br>    <span class="hljs-keyword">private</span> String _name;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>._name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String value)</span>&#123;<br>        <span class="hljs-built_in">this</span>._name = value;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IUser</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(User user)</span>;<br>    User <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>;<br>&#125;<br><br><span class="hljs-comment">// 部门类接口</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IDepartment</span>&#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(Department department)</span>;<br>    Department <span class="hljs-title function_">getDepartment</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SqlserverUser</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IUser</span>&#123;<br><br>    <span class="hljs-comment">// 新增一个用户</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(User user)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;在SQL Server中给User表增加一条记录&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// 获取一个用户信息</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;在SQL Server中根据用户ID得到User表一条记录&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AccessUser</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IUser</span>&#123;<br><br>    <span class="hljs-comment">// 新增一个用户</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(User user)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;在Access中给User表增加一条记录&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;在Access中根据用户ID得到User表一条记录&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SqlserverDepartment</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDepartment</span>&#123;<br><br>    <span class="hljs-comment">// 新增一个部门</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(Department department)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;在SQLServer中给Department表增加一条记录&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Department <span class="hljs-title function_">getDepartment</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;在SQL Server中根据部门ID得到Department表一条记录&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AccessDepartment</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDepartment</span>&#123;<br><br>    <span class="hljs-comment">// 新增一个部门</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(Department department)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;在Access中给Department表增加一条记录&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Department <span class="hljs-title function_">getDepartment</span><span class="hljs-params">(<span class="hljs-type">int</span> id)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;在Access中根据部门ID得到Department表一条记录&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 工厂接口</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IFactory</span>&#123;<br>    IUser <span class="hljs-title function_">createUser</span><span class="hljs-params">()</span>;<br>    IDepartment <span class="hljs-title function_">createDepartment</span><span class="hljs-params">()</span>; <span class="hljs-comment">// 增加的接口方法</span><br>&#125;<br><br><span class="hljs-comment">// Sqlserver工厂</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SqlserverFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IFactory</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IUser <span class="hljs-title function_">createUser</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlserverUser</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IDepartment <span class="hljs-title function_">createDepartment</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlserverDepartment</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// Access工厂</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AccessFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IFactory</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IUser <span class="hljs-title function_">createUser</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AccessUser</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> IDepartment <span class="hljs-title function_">createDepartment</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AccessDepartment</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>特点：</strong></p>
<ul>
<li>易于交换产品系列，由于具体工厂类，在一应用中只需要在初始化的时候出现一次，这就使得改变一个应用的具体工厂变得非常容易，它只需要改变具体工厂即可使用不同的产品配置。</li>
<li>它让具体的创建实例过程与客户端分离，客户端是通过它们的抽象接口操纵实例，产品的具体类名也被具体工厂的实现分离，不会出现在客户代码中。</li>
</ul>
<h3 id="第-16-章-状态模式">第 16 章 状态模式</h3>
<p><strong>状态模式（State），当一个对象的内在状态改变时允许改变其行为，这个对象看起来像是改变了其类。</strong></p>
<p><img src="https://cdn.gumengyo.top/Snipaste_2023-05-11_08-37-15.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter16;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StatePattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">// 紧急项目</span><br>        <span class="hljs-type">Work</span> <span class="hljs-variable">emergencyProjects</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Work</span>();<br>        emergencyProjects.setHour(<span class="hljs-number">9</span>);<br>        emergencyProjects.writeProgram();<br>        emergencyProjects.setHour(<span class="hljs-number">10</span>);<br>        emergencyProjects.writeProgram();<br>        emergencyProjects.setHour(<span class="hljs-number">12</span>);<br>        emergencyProjects.writeProgram();<br>        emergencyProjects.setHour(<span class="hljs-number">13</span>);<br>        emergencyProjects.writeProgram();<br>        emergencyProjects.setHour(<span class="hljs-number">14</span>);<br>        emergencyProjects.writeProgram();<br>        emergencyProjects.setHour(<span class="hljs-number">17</span>);<br><br>        emergencyProjects.setWorkFinished(<span class="hljs-literal">false</span>);<br><br>        emergencyProjects.writeProgram();<br>        emergencyProjects.setHour(<span class="hljs-number">19</span>);<br>        emergencyProjects.writeProgram();<br>        emergencyProjects.setHour(<span class="hljs-number">22</span>);<br>        emergencyProjects.writeProgram();<br><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 工作类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Work</span>&#123;<br><br>    <span class="hljs-keyword">private</span> State current;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Work</span><span class="hljs-params">()</span>&#123;<br>        current = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ForenoonState</span>();<br>    &#125;<br>    <span class="hljs-comment">// 设置状态</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(State value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.current =value;<br>    &#125;<br><br>    <span class="hljs-comment">// 写代码的状态</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeProgram</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-built_in">this</span>.current.writeProgram(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// 时间终点</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> hour;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHour</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.hour;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setHour</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> &#123;<br>        <span class="hljs-built_in">this</span>.hour = value;<br>    &#125;<br>    <span class="hljs-comment">// 是否完成工作任务</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">workFinished</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">getWorkFinished</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.workFinished;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setWorkFinished</span><span class="hljs-params">(<span class="hljs-type">boolean</span> value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.workFinished = value;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeProgram</span><span class="hljs-params">(Work w)</span>;<br>&#125;<br><br><span class="hljs-comment">// 上午工作状态</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForenoonState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeProgram</span> <span class="hljs-params">(Work w)</span>&#123;<br>        <span class="hljs-keyword">if</span> (w.getHour() &lt; <span class="hljs-number">12</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;当前时间：&quot;</span> + w.getHour() + <span class="hljs-string">&quot;点 上午工作，精神百倍&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            w.setState(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NoonState</span>());<br>            w.writeProgram();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 中午工作状态</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NoonState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeProgram</span> <span class="hljs-params">(Work w)</span>&#123;<br>        <span class="hljs-keyword">if</span> (w.getHour() &lt; <span class="hljs-number">13</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;当前时间：&quot;</span> + w.getHour() + <span class="hljs-string">&quot;点 饿了，午饭：犯困，午休&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            w.setState(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AfternoonState</span>());<br>            w.writeProgram();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 下午工作状态</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AfternoonState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeProgram</span> <span class="hljs-params">(Work w)</span>&#123;<br>        <span class="hljs-keyword">if</span> (w.getHour() &lt; <span class="hljs-number">17</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;当前时间：&quot;</span> + w.getHour() + <span class="hljs-string">&quot;点 下午状态还不错，继续努力&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            w.setState(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EveningState</span>());<br>            w.writeProgram();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 晚间工作状态</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">EveningState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeProgram</span> <span class="hljs-params">(Work w)</span>&#123;<br>        <span class="hljs-keyword">if</span> (w.getWorkFinished())&#123;<br>            w.setState(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RestState</span>());<br>            w.writeProgram();<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (w.getHour() &lt; <span class="hljs-number">21</span>)&#123;<br>                System.out.println(<span class="hljs-string">&quot;当前时间：&quot;</span> + w.getHour() + <span class="hljs-string">&quot;点 加班哦，疲累之极&quot;</span>);<br>            &#125;<span class="hljs-keyword">else</span> &#123;<br>                w.setState(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SleepingState</span>());<br>                w.writeProgram();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 睡眠状态</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SleepingState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeProgram</span><span class="hljs-params">(Work w)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;当前时间:&quot;</span>  + w.getHour() + <span class="hljs-string">&quot;点 不行了，睡着了。&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 下班休息状态</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RestState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeProgram</span><span class="hljs-params">(Work w)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;当前时间:&quot;</span>  + w.getHour() + <span class="hljs-string">&quot;点 下班回家了。&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p><strong>状态模式的好处与用处：</strong></p>
<ul>
<li>将与特定状态相关的行为局部化，并且将不同状态的行为分割开来。</li>
<li>消除庞大的条件分支语句，状态模式通过把各种状态转移逻辑分布到State的子类之间，来减少相互间的依赖。</li>
<li>当一个对象的行为取决于它的状态，并且它必须在运行时刻根据状态改变它的行为时，就可以考虑使用状态模式了。</li>
</ul>
<h3 id="第-17-章-适配器模式">第 17 章 适配器模式</h3>
<p><strong>适配器模式（Adapter），将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</strong></p>
<p><img src="https://cdn.gumengyo.top/Snipaste_2023-05-11_09-32-09.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter17;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdapterPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Player</span> <span class="hljs-variable">forwards</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Forwards</span>(<span class="hljs-string">&quot;巴蒂尔&quot;</span>);<br>        forwards.attack();<br><br>        <span class="hljs-type">Player</span> <span class="hljs-variable">guards</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Guards</span>(<span class="hljs-string">&quot;麦克格雷迪&quot;</span>);<br>        guards.attack();<br><br>        <span class="hljs-type">Player</span> <span class="hljs-variable">center</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Translator</span>(<span class="hljs-string">&quot;姚明&quot;</span>);<br><br>        center.attack();<br>        center.defense();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 球员</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Player</span>&#123;<br>    <span class="hljs-keyword">protected</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Player</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span>; <span class="hljs-comment">// 进攻</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defense</span><span class="hljs-params">()</span>; <span class="hljs-comment">// 防守</span><br>&#125;<br><br><span class="hljs-comment">// 前锋</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Forwards</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Player</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Forwards</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">super</span>(name);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;前锋 &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; 进攻&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defense</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;前锋 &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; 防守&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 前锋</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Center</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Player</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Center</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">super</span>(name);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;中锋 &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; 进攻&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defense</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;中锋 &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; 防守&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 后卫</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Guards</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Player</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Guards</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">super</span>(name);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;后卫 &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; 进攻&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defense</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;后卫 &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; 防守&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 外籍中锋</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForeignCenter</span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String value)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = value;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> 进攻()&#123;<br>        System.out.println(<span class="hljs-string">&quot;外籍中锋 &quot;</span> +<span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; 进攻&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> 防守()&#123;<br>        System.out.println(<span class="hljs-string">&quot;外籍中锋 &quot;</span> +<span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; 防守&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 翻译者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Translator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Player</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">ForeignCenter</span> <span class="hljs-variable">foreignCenter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ForeignCenter</span>();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Translator</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">super</span>(name);<br>        foreignCenter.setName(name);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attack</span><span class="hljs-params">()</span> &#123;<br>        foreignCenter.进攻();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defense</span><span class="hljs-params">()</span> &#123;<br>        foreignCenter.防守();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="第-18-章-备忘录模式">第 18 章 备忘录模式</h3>
<p><strong>备忘录（Memento）：在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到原先保存的状态。</strong></p>
<p><img src="https://cdn.gumengyo.top/Snipaste_2023-05-11_10-19-19.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter18;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MementoPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Originator</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Originator</span>();<br>        o.setState(<span class="hljs-string">&quot;On&quot;</span>);<br>        o.show();<br><br>        <span class="hljs-type">Caretaker</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Caretaker</span>();<br>        <span class="hljs-comment">// 保存状态时，由于有了很好的封装，可以隐藏Originator的实现细节</span><br>        c.setMemento(o.createMemento());<br><br>        <span class="hljs-comment">// Originator改变了状态属性为&quot;off&quot;</span><br>        o.setState(<span class="hljs-string">&quot;off&quot;</span>);<br>        o.show();<br><br>        <span class="hljs-comment">// 恢复原初始状态</span><br>        o.recoveryMemento(c.getMemento());<br>        o.show();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 发起人</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Originator</span>&#123;<br><br>    <span class="hljs-comment">// 状态</span><br>    <span class="hljs-keyword">private</span> String state;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getState</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.state;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(String value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.state = value;<br>    &#125;<br>    <span class="hljs-comment">// 显示数据</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;State:&quot;</span> + <span class="hljs-built_in">this</span>.state);<br>    &#125;<br>    <span class="hljs-comment">// 创建备忘录</span><br>    <span class="hljs-keyword">public</span> Memento <span class="hljs-title function_">createMemento</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Memento</span>(<span class="hljs-built_in">this</span>.state);<br>    &#125;<br>    <span class="hljs-comment">// 恢复备忘录</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recoveryMemento</span><span class="hljs-params">(Memento memento)</span>&#123;<br>        <span class="hljs-built_in">this</span>.setState(memento.getState());<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 备忘录</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Memento</span>&#123;<br>    <span class="hljs-keyword">private</span> String state;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Memento</span><span class="hljs-params">(String state)</span>&#123;<br>        <span class="hljs-built_in">this</span>.state = state;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getState</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.state;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(String value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.state = value;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 管理者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Caretaker</span>&#123;<br>    <span class="hljs-keyword">private</span> Memento memento;<br>    <span class="hljs-keyword">public</span> Memento <span class="hljs-title function_">getMemento</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.memento;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMemento</span><span class="hljs-params">(Memento value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.memento = value;<br>    &#125;<br><br><br>&#125;<br><br></code></pre></td></tr></table></figure>
<h3 id="第-19-章-组合模式">第 19 章 组合模式</h3>
<p><strong>组合模式（Composite），将对象组合成树形结构以表示‘部分-整体’的层次结构。组合模式使得用户对单个对象和组合对象的使用具有一致性。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230515181230670.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter19;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CompositePattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Composite</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Composite</span>(<span class="hljs-string">&quot;root&quot;</span>);<br>        root.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Leaf</span>(<span class="hljs-string">&quot;Leaf A&quot;</span>));<br>        root.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Leaf</span>(<span class="hljs-string">&quot;Leaf B&quot;</span>));<br><br>        <span class="hljs-type">Composite</span> <span class="hljs-variable">comp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Composite</span>(<span class="hljs-string">&quot;Composite X&quot;</span>);<br>        comp.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Leaf</span>(<span class="hljs-string">&quot;Leaf XA&quot;</span>));<br>        comp.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Leaf</span>(<span class="hljs-string">&quot;Leaf XB&quot;</span>));<br>        root.add(comp);<br><br>        <span class="hljs-type">Composite</span> <span class="hljs-variable">comp2</span> <span class="hljs-operator">=</span>  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Composite</span>(<span class="hljs-string">&quot;Composite XY&quot;</span>);<br>        comp2.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Leaf</span>(<span class="hljs-string">&quot;Leaf XYA&quot;</span>));<br>        comp2.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Leaf</span>(<span class="hljs-string">&quot;Leaf XYB&quot;</span>));<br>        comp.add(comp2);<br><br>        <span class="hljs-type">Leaf</span> <span class="hljs-variable">leaf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Leaf</span>(<span class="hljs-string">&quot;Leaf C&quot;</span>);<br>        root.add(leaf);<br><br>        <span class="hljs-type">Leaf</span> <span class="hljs-variable">leaf2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Leaf</span>(<span class="hljs-string">&quot;Leaf D&quot;</span>);<br>        root.add(leaf2);<br>        root.remove(leaf2);<br><br>        root.display(<span class="hljs-number">1</span>);<br><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span>&#123;<br>    <span class="hljs-keyword">protected</span> String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Component</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Component component)</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Component component)</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">(<span class="hljs-type">int</span> depth)</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Leaf</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Leaf</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">super</span>(name);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Component component)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Cannot add to a leaf.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Component component)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;Cannot remove from a leaf.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">(<span class="hljs-type">int</span> depth)</span> &#123;<br>        <span class="hljs-comment">// 叶节点的具体显示方法，此处是显示其名称和级别</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; depth; i++)<br>            System.out.print(<span class="hljs-string">&quot;-&quot;</span>);<br>        System.out.println(name);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Composite</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span>&#123;<br><br>    <span class="hljs-keyword">private</span> ArrayList&lt;Component&gt; children = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Component&gt;(); <span class="hljs-comment">// 一个子对象集合用来存储其下属的枝节点和叶节点</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Composite</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">super</span>(name);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Component component)</span> &#123;<br>        children.add(component);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Component component)</span> &#123;<br>        children.remove(component);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">(<span class="hljs-type">int</span> depth)</span> &#123;<br>        <span class="hljs-comment">// 显示其枝节点名称</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i&lt;depth;i++)<br>            System.out.print(<span class="hljs-string">&quot;-&quot;</span>);<br>        System.out.println(name);<br>        <span class="hljs-comment">// 对其下级进行遍历</span><br>        <span class="hljs-keyword">for</span> (Component item : children) &#123;<br>            item.display(depth+<span class="hljs-number">2</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>需求中是体现部分与整体层次的结构时，希望用户可以忽略组合对象与单个对象的不同，统一地使用组合结构中的所有对象时，就应该考虑用组合模式。</p>
<h3 id="第-20-章-迭代器模式">第 20 章 迭代器模式</h3>
<p><strong>迭代器模式（Iterator），提供一种方法顺序访问一个聚合对象中的各个元素，而又不暴露该对象的内部表示。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230515193830432.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter20;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IteratorPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ConcreteAggregate</span> <span class="hljs-variable">bus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteAggregate</span>();<br>        bus.add(<span class="hljs-string">&quot;大鸟&quot;</span>);<br>        bus.add(<span class="hljs-string">&quot;小菜&quot;</span>);<br>        bus.add(<span class="hljs-string">&quot;行李&quot;</span>);<br>        bus.add(<span class="hljs-string">&quot;老外&quot;</span>);<br>        bus.add(<span class="hljs-string">&quot;公交内部员工&quot;</span>);<br>        bus.add(<span class="hljs-string">&quot;小偷&quot;</span>);<br><br>        <span class="hljs-type">Iterator</span> <span class="hljs-variable">conductor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteIterator</span>(bus);<br><br>        conductor.first();<br>        <span class="hljs-keyword">while</span> (!conductor.isDone())&#123;<br>            System.out.println(conductor.currentItem() + <span class="hljs-string">&quot;，请买车票!&quot;</span>);<br>            conductor.next();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 聚集抽象类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Aggregate</span>&#123;<br>    <span class="hljs-comment">// 创建迭代器</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Iterator <span class="hljs-title function_">createIterator</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">// 具体聚集类，继承Aggregate</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteAggregate</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Aggregate</span>&#123;<br><br>    <span class="hljs-comment">// 声明一个ArrayList泛型变量，用于存放聚合对象</span><br>    <span class="hljs-keyword">private</span> ArrayList&lt;Object&gt; items = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Object&gt;();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Iterator <span class="hljs-title function_">createIterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteIterator</span>(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// 返回聚焦总个数</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCount</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> items.size();<br>    &#125;<br><br>    <span class="hljs-comment">// 增加新对象</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Object object)</span>&#123;<br>        items.add(object);<br>    &#125;<br><br>    <span class="hljs-comment">// 得到指定索引对象</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getCurrentItem</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>&#123;<br>        <span class="hljs-keyword">return</span> items.get(index);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 迭代器抽象类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Iterator</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Object <span class="hljs-title function_">first</span><span class="hljs-params">()</span>;             <span class="hljs-comment">// 第一个</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Object <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;              <span class="hljs-comment">// 下一个</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDone</span><span class="hljs-params">()</span>;            <span class="hljs-comment">// 是否到最后</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Object <span class="hljs-title function_">currentItem</span><span class="hljs-params">()</span>;       <span class="hljs-comment">// 当前对象</span><br>&#125;<br><br><span class="hljs-comment">// 具体迭代器类，继承Iterator</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteIterator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Iterator</span>&#123;<br><br>    <span class="hljs-keyword">private</span> ConcreteAggregate aggregate;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">// 初始化时将具体的聚焦对象传入</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConcreteIterator</span><span class="hljs-params">(ConcreteAggregate aggregate)</span>&#123;<br>        <span class="hljs-built_in">this</span>.aggregate = aggregate;<br>    &#125;<br><br>    <span class="hljs-comment">// 得到第一个对象</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">first</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> aggregate.getCurrentItem(<span class="hljs-number">0</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// 得到下一个对象</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">ret</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        current++;<br>        <span class="hljs-keyword">if</span> (current &lt; aggregate.getCount())&#123;<br>            ret = aggregate.getCurrentItem(current);<br>        &#125;<br>        <span class="hljs-keyword">return</span> ret;<br>    &#125;<br><br>    <span class="hljs-comment">// 判断当前是否遍历到结尾，到结尾返回true</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDone</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> current &gt;= aggregate.getCount() ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 返回当前的聚集对象</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">currentItem</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> aggregate.getCurrentItem(current);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>当你需要对聚集有多种方式遍历时，可以考虑用迭代器模式。</p>
<p>迭代器（Iterator）模式就是分离了集合对象的遍历行为，抽象出一个迭代器类来负责，这样既可以做到不暴露集合的内部结构，又可以让外部代码透明地访问集合内部的数据。</p>
<h3 id="第-21-章-单例模式">第 21 章 单例模式</h3>
<p><strong>单例模式（Singleton），保证一个类仅有一个实例，并提供一个访问它的全局访问点。</strong></p>
<p><strong>懒汉单例：要在第一次被引用时，才会将自己实例化</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 单例模式（懒汉单例）</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton instance;<br><br>    <span class="hljs-comment">// 构造方法private化</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton1</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-comment">// 得到Singleton的实例（唯一途径）</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>)&#123;<br>            instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>饿汉单例：静态初始化的方式是在自己被加载时就将自己实例化</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Singleton</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();<br><br>    <span class="hljs-comment">// 构造方法private化</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-comment">// 得到Singleton的实例（唯一途径）</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="第-22-章-桥接模式">第 22 章 桥接模式</h3>
<p><strong>合成/聚合复用原则（CAPP），尽量使用合成/聚合，尽量不要使用类继承。</strong></p>
<p><strong>桥接模式（Bridge），将抽象部分与它的实现部分分离，使它们都可以独立地变化。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230516164259051.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter22;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BridgePattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        Abstraction ab;<br>        ab = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RefinedAbstraction</span>();<br><br>        ab.setImplementor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteImplementorA</span>());<br>        ab.operation();<br><br>        ab.setImplementor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteImplementorB</span>());<br>        ab.operation();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Implementor</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteImplementorA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Implementor</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;具体实现A的方法执行&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteImplementorB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Implementor</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;具体实现B的方法执行&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Abstraction</span>&#123;<br>    <span class="hljs-keyword">protected</span> Implementor implementor;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setImplementor</span><span class="hljs-params">(Implementor implementor)</span>&#123;<br>        <span class="hljs-built_in">this</span>.implementor = implementor;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RefinedAbstraction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Abstraction</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;具体的Abstraction&quot;</span>);<br>        implementor.operation();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>实现系统可能有多角度分类，每一种分类都有可能变化，那么就把这种多角度分离出来让它们独立变化，减少它们之间的耦合。</strong></p>
<h3 id="第-23-章-命令模式">第 23 章 命令模式</h3>
<p><strong>命令模式（Command），讲一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可撤销的操作。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter23;<br><br><span class="hljs-keyword">import</span> java.text.SimpleDateFormat;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CommandPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">// 开店前的准备</span><br>        <span class="hljs-type">Barbecuer</span> <span class="hljs-variable">boy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Barbecuer</span>(); <span class="hljs-comment">// 烤肉厨师</span><br>        <span class="hljs-type">Command</span> <span class="hljs-variable">bakeMuttonCommand1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BakeMuttonCommand</span>(boy);    <span class="hljs-comment">// 烤羊肉串</span><br>        <span class="hljs-type">Command</span> <span class="hljs-variable">bakeChickenWingCommand1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BakeChickenWingCommand</span>(boy);    <span class="hljs-comment">// 烤羊肉串</span><br>        <span class="hljs-type">Waiter</span> <span class="hljs-variable">girl</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Waiter</span>(); <span class="hljs-comment">// 服务员</span><br><br>        System.out.println(<span class="hljs-string">&quot;开门营业，顾客点菜&quot;</span>);<br>        girl.setOrder(bakeMuttonCommand1);      <span class="hljs-comment">// 下单烤羊肉串</span><br>        girl.setOrder(bakeMuttonCommand1);      <span class="hljs-comment">// 下单烤羊肉串</span><br>        girl.setOrder(bakeMuttonCommand1);      <span class="hljs-comment">// 下单烤羊肉串</span><br>        girl.setOrder(bakeMuttonCommand1);      <span class="hljs-comment">// 下单烤羊肉串</span><br>        girl.setOrder(bakeMuttonCommand1);      <span class="hljs-comment">// 下单烤羊肉串</span><br><br>        girl.cancelOrder(bakeMuttonCommand1);   <span class="hljs-comment">// 取消一串羊肉串订单</span><br><br>        girl.setOrder(bakeChickenWingCommand1); <span class="hljs-comment">// 下单烤鸡翅</span><br><br>        System.out.println(<span class="hljs-string">&quot;点菜完毕，通知厨房烧菜&quot;</span>);<br>        girl.notifyCommand();       <span class="hljs-comment">//通知厨师</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 烤肉串者</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Barbecuer</span>&#123;<br>    <span class="hljs-comment">// 烤羊肉</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bakeMutton</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;烤羊肉串！&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">// 烤鸡翅</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bakeChickenWing</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;烤鸡翅！&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 抽象命令类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Command</span>&#123;<br>    <span class="hljs-keyword">protected</span> Barbecuer receiver;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Command</span><span class="hljs-params">(Barbecuer receiver)</span>&#123;<br>        <span class="hljs-built_in">this</span>.receiver = receiver;<br>    &#125;<br>    <span class="hljs-comment">// 执行命令</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">excuteCommand</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">// 烤羊肉命令类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BakeMuttonCommand</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Command</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BakeMuttonCommand</span><span class="hljs-params">(Barbecuer receiver)</span>&#123;<br>        <span class="hljs-built_in">super</span>(receiver);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">excuteCommand</span><span class="hljs-params">()</span> &#123;<br>        receiver.bakeMutton();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 烤鸡翅命令类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BakeChickenWingCommand</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Command</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BakeChickenWingCommand</span><span class="hljs-params">(Barbecuer receiver)</span>&#123;<br>        <span class="hljs-built_in">super</span>(receiver);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">excuteCommand</span><span class="hljs-params">()</span> &#123;<br>        receiver.bakeChickenWing();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 服务员类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Waiter</span>&#123;<br>    <span class="hljs-keyword">private</span> ArrayList&lt;Command&gt; orders = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Command&gt;();<br><br>    <span class="hljs-comment">// 设置订单</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setOrder</span><span class="hljs-params">(Command command)</span>&#123;<br>        String className= command.getClass().getSimpleName();<br><br>        <span class="hljs-keyword">if</span> (className.equals(<span class="hljs-string">&quot;BakeChickenWingCommand&quot;</span>))&#123;<br>            System.out.println(<span class="hljs-string">&quot;服务员：鸡翅没有了，请点别的烧烤。&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-built_in">this</span>.orders.add(command);<br>            System.out.println(<span class="hljs-string">&quot;增加订单：&quot;</span>+className + <span class="hljs-string">&quot;时间：&quot;</span>+getNowTime());<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// 取消订单</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancelOrder</span><span class="hljs-params">(Command command)</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> command.getClass().getSimpleName();<br>        orders.remove(command);<br>        System.out.println(<span class="hljs-string">&quot;取消订单：&quot;</span>+className+<span class="hljs-string">&quot; 时间：&quot;</span> + getNowTime());<br>    &#125;<br>    <span class="hljs-comment">// 通知执行</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyCommand</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">for</span> (Command command : orders) &#123;<br>            command.excuteCommand();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getNowTime</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">SimpleDateFormat</span> <span class="hljs-variable">formatter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">&quot;HH:mm:ss&quot;</span>);<br>        <span class="hljs-keyword">return</span> formatter.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).toString();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>优点：</p>
<ul>
<li>能较容易地设计一个命令队列</li>
<li>在需要的情况下，可以较容易地将命令记入日志</li>
<li>允许接收请求的一方决定是否要否决请求</li>
<li>可以容易地实现对请求的撤销和重做</li>
<li>由于加进新的具体命令类不影响其他的类，因此增加新的具体命令类很容易</li>
<li>命令模式把请求一个操作的对象与知道怎么执行一个操作的对象分隔开</li>
</ul>
<h3 id="第-24-章-职责链模式">第 24 章 职责链模式</h3>
<p><strong>职责链模式（Chain of Responsibility）：使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这个对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230517165824783.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter24;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChainOfResponsibilityPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Handler</span> <span class="hljs-variable">h1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteHandler1</span>();<br>        <span class="hljs-type">Handler</span> <span class="hljs-variable">h2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteHandler2</span>();<br>        <span class="hljs-type">Handler</span> <span class="hljs-variable">h3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteHandler3</span>();<br>        h1.setSuccessor(h2);<br>        h2.setSuccessor(h3);<br><br>        <span class="hljs-type">int</span>[] requests = &#123;<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">14</span>,<span class="hljs-number">22</span>,<span class="hljs-number">18</span>,<span class="hljs-number">3</span>,<span class="hljs-number">27</span>,<span class="hljs-number">20</span>&#125;;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> request : requests) &#123;<br>            h1.handleRequest(request);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Handler</span>&#123;<br>    <span class="hljs-keyword">protected</span> Handler successor;<br><br>    <span class="hljs-comment">// 设置继任者</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSuccessor</span><span class="hljs-params">(Handler successor)</span> &#123;<br>        <span class="hljs-built_in">this</span>.successor = successor;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRequest</span><span class="hljs-params">(<span class="hljs-type">int</span> request)</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteHandler1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRequest</span><span class="hljs-params">(<span class="hljs-type">int</span> request)</span> &#123;<br>        <span class="hljs-keyword">if</span> (request &gt;= <span class="hljs-number">0</span> &amp;&amp; request &lt; <span class="hljs-number">10</span>)&#123;<br>            System.out.println(<span class="hljs-built_in">this</span>.getClass().getSimpleName() + <span class="hljs-string">&quot; 处理请求 &quot;</span>+request);<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(successor != <span class="hljs-literal">null</span>)&#123;<br>            successor.handleRequest(request);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteHandler2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRequest</span><span class="hljs-params">(<span class="hljs-type">int</span> request)</span> &#123;<br>        <span class="hljs-keyword">if</span> (request &gt;= <span class="hljs-number">10</span> &amp;&amp; request &lt; <span class="hljs-number">20</span>)&#123;<br>            System.out.println(<span class="hljs-built_in">this</span>.getClass().getSimpleName() + <span class="hljs-string">&quot; 处理请求 &quot;</span>+request);<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(successor != <span class="hljs-literal">null</span>)&#123;<br>            successor.handleRequest(request);<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteHandler3</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRequest</span><span class="hljs-params">(<span class="hljs-type">int</span> request)</span> &#123;<br>        <span class="hljs-keyword">if</span> (request &gt;= <span class="hljs-number">20</span> &amp;&amp; request &lt; <span class="hljs-number">30</span>)&#123;<br>            System.out.println(<span class="hljs-built_in">this</span>.getClass().getSimpleName() + <span class="hljs-string">&quot; 处理请求 &quot;</span>+request);<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(successor != <span class="hljs-literal">null</span>)&#123;<br>            successor.handleRequest(request);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><strong>职责链的好处：</strong></p>
<ul>
<li>接收者和发送者都没有对方的明确信息，且链中的对象自己也并不知道链的结构。结果是职责链可简化对象的相互连接，它们仅需保持一个指向其后继者的引用，而不需保持它所有的候选接收者的引用。</li>
<li>可以随时地增加或修改处理一个请求的结构。增强了给对象指派职责的灵活性。</li>
</ul>
<h3 id="第-25-章-中介者模式">第 25 章 中介者模式</h3>
<p><strong>中介者模式（Mediator），用一个中介对象来封装一系列的对象交互。中介者使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230517171344605.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter25;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MediatorPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ConcreteMediator</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteMediator</span>();<br><br>        <span class="hljs-type">ConcreteColleague1</span> <span class="hljs-variable">c1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteColleague1</span>(m);<br>        <span class="hljs-type">ConcreteColleague2</span> <span class="hljs-variable">c2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteColleague2</span>(m);<br><br>        m.setColleague1(c1);<br>        m.setColleague2(c2);<br><br>        c1.send(<span class="hljs-string">&quot;吃过饭了吗？&quot;</span>);<br>        c2.send(<span class="hljs-string">&quot;没有呢，你打算请客？&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Colleague</span>&#123;<br>    <span class="hljs-keyword">protected</span> Mediator mediator;<br>    <span class="hljs-comment">// 构造方法，得到中介者对象</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Colleague</span><span class="hljs-params">(Mediator mediator)</span>&#123;<br>        <span class="hljs-built_in">this</span>.mediator = mediator;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteColleague1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Colleague</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConcreteColleague1</span><span class="hljs-params">(Mediator mediator)</span>&#123;<br>        <span class="hljs-built_in">super</span>(mediator);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message)</span> &#123;<br>        <span class="hljs-built_in">this</span>.mediator.send(message,<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notify</span><span class="hljs-params">(String message)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;同事1得到信息：&quot;</span>+message);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteColleague2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Colleague</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConcreteColleague2</span><span class="hljs-params">(Mediator mediator)</span>&#123;<br>        <span class="hljs-built_in">super</span>(mediator);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message)</span> &#123;<br>        <span class="hljs-built_in">this</span>.mediator.send(message,<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notify</span><span class="hljs-params">(String message)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;同事2得到信息：&quot;</span>+message);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 中介者类</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Mediator</span>&#123;<br>    <span class="hljs-comment">// 定义一个抽象的发送消息方法，得到同事对象和发送消息</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message,Colleague colleague)</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteMediator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Mediator</span> &#123;<br><br>    <span class="hljs-keyword">private</span> ConcreteColleague1 colleague1;<br>    <span class="hljs-keyword">private</span> ConcreteColleague2 colleague2;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setColleague1</span><span class="hljs-params">(ConcreteColleague1 value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.colleague1 = value;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setColleague2</span><span class="hljs-params">(ConcreteColleague2 value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.colleague2 = value;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message, Colleague colleague)</span> &#123;<br>        <span class="hljs-keyword">if</span> (colleague == colleague1)&#123;<br>            colleague2.notify(message);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            colleague1.notify(message);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>中介者模式一般应用于一组对象以定义良好但是复杂的方式进行通信的场合，以及想定制一个分布在多个类中的行为，而又不想生成太多的子类的场合。</p>
<h3 id="第-26-章-享元模式">第 26 章 享元模式</h3>
<p><strong>享元模式（Flyweight），运用共享技术有效地支持大量细粒度的对象。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230518185501261.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter26;<br><br><span class="hljs-keyword">import</span> java.util.Hashtable;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlyweightPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">extrinsicstate</span> <span class="hljs-operator">=</span> <span class="hljs-number">22</span>;<br><br>        <span class="hljs-type">FlyweightFactory</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FlyweightFactory</span>();<br><br>        <span class="hljs-type">Flyweight</span> <span class="hljs-variable">fx</span> <span class="hljs-operator">=</span> f.getFlyweight(<span class="hljs-string">&quot;X&quot;</span>);<br>        fx.operation(--extrinsicstate);<br><br>        <span class="hljs-type">Flyweight</span> <span class="hljs-variable">fy</span> <span class="hljs-operator">=</span> f.getFlyweight(<span class="hljs-string">&quot;Y&quot;</span>);<br>        fy.operation(--extrinsicstate);<br><br>        <span class="hljs-type">Flyweight</span> <span class="hljs-variable">fz</span> <span class="hljs-operator">=</span> f.getFlyweight(<span class="hljs-string">&quot;Z&quot;</span>);<br>        fz.operation(--extrinsicstate);<br><br>        <span class="hljs-type">Flyweight</span> <span class="hljs-variable">uf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsharedConcreteFlyweight</span>();<br><br>        uf.operation(--extrinsicstate);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Flyweight</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">(<span class="hljs-type">int</span> extrinsicstate)</span>;<br>&#125;<br><br><span class="hljs-comment">// 需要共享的具体Flyweight子类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteFlyweight</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Flyweight</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">(<span class="hljs-type">int</span> extrinsicstate)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;具体Flyweight:&quot;</span> + extrinsicstate);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 不需要共享的Flyweight子类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">UnsharedConcreteFlyweight</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Flyweight</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operation</span><span class="hljs-params">(<span class="hljs-type">int</span> extrinsicstate)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;不共享的具体Flyweight:&quot;</span> + extrinsicstate);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 享元工厂</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">FlyweightFactory</span>&#123;<br>    <span class="hljs-keyword">private</span> Hashtable&lt;String,Flyweight&gt; flyweights = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hashtable</span>&lt;String,Flyweight&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FlyweightFactory</span><span class="hljs-params">()</span>&#123;<br>        flyweights.put(<span class="hljs-string">&quot;X&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteFlyweight</span>());<br>        flyweights.put(<span class="hljs-string">&quot;Y&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteFlyweight</span>());<br>        flyweights.put(<span class="hljs-string">&quot;Z&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteFlyweight</span>());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Flyweight <span class="hljs-title function_">getFlyweight</span><span class="hljs-params">(String key)</span>&#123;<br>        <span class="hljs-keyword">return</span> flyweights.get(key);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>如果一个应用程序使用了大量的对象，而大量的这些对象造成了很大的存储开销时就应该考虑使用享元模式；还有就是对象的大多数状态可以是外部状态，如果删除对象的外部状态，那么可以相对较少的共享对象取代很多组对象，此时可以考虑使用享元模式。</p>
<h3 id="第-27-章-解释器模式">第 27 章 解释器模式</h3>
<p><strong>解释器模式（interpreter），给定一个语言，定义它的文法的一种表示，并定义一个解释器，这个解释器使用该表示来解释语言中的句子。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230518191404357.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter27;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterpreterPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Context</span>();<br>        ArrayList&lt;AbstractExpression&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;AbstractExpression&gt;();<br>        list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>());<br>        list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NonterminalExpression</span>());<br>        list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>());<br>        list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TerminalExpression</span>());<br><br>        <span class="hljs-keyword">for</span> (AbstractExpression exp : list) &#123;<br>            exp.interpret(context);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 抽象表达式</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractExpression</span>&#123;<br>    <span class="hljs-comment">// 解释操作</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">interpret</span><span class="hljs-params">(Context context)</span>;<br>&#125;<br><br><span class="hljs-comment">// 终结符表达式</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TerminalExpression</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExpression</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">interpret</span><span class="hljs-params">(Context context)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;终端解释器&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 非终结符表达式</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NonterminalExpression</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExpression</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">interpret</span><span class="hljs-params">(Context context)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;非终端解释器&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Context</span>&#123;<br>    <span class="hljs-keyword">private</span> String input;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getInput</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.input;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setInput</span><span class="hljs-params">(String value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.input = value;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> String output;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getOutput</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.output;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setOutput</span><span class="hljs-params">(String value)</span>&#123;<br>        <span class="hljs-built_in">this</span>.output = value;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>如果一种特定类型的问题发生的频率足够高，那么可能就值得将该问题的各个实例表述为一个简单语言中的句子。</p>
<p>这样就可以构建一个解释器，该解释器通过解释这些句子来解决该问题。</p>
<h3 id="第-28-章-访问者模式">第 28 章 访问者模式</h3>
<p><strong>访问者模式（Visitor），表示一个作用于某对象结构中的各元素的操作。它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。</strong></p>
<p><img src="https://cdn.gumengyo.top//image-20230520200148737.png" srcset="/img/loading.gif" lazyload alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.jishuqin.chapter28;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VisitorPattern</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ObjectStructure</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectStructure</span>();<br>        o.attach(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteElementA</span>());<br>        o.attach(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteElementB</span>());<br><br>        <span class="hljs-type">ConcreteVisitor1</span> <span class="hljs-variable">v1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteVisitor1</span>();<br>        <span class="hljs-type">ConcreteVisitor2</span> <span class="hljs-variable">v2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteVisitor2</span>();<br><br>        o.accept(v1);<br>        o.accept(v2);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Visitor</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visitConcreteElementA</span><span class="hljs-params">(ConcreteElementA concreteElementA)</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visitConcreteElementB</span><span class="hljs-params">(ConcreteElementB concreteElementB)</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteVisitor1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Visitor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visitConcreteElementA</span><span class="hljs-params">(ConcreteElementA concreteElementA)</span> &#123;<br>        System.out.println(concreteElementA.getClass().getSimpleName()+<span class="hljs-string">&quot;被&quot;</span>+<span class="hljs-built_in">this</span>.getClass().getSimpleName()+<span class="hljs-string">&quot;访问&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visitConcreteElementB</span><span class="hljs-params">(ConcreteElementB concreteElementB)</span> &#123;<br>        System.out.println(concreteElementB.getClass().getSimpleName()+<span class="hljs-string">&quot;被&quot;</span>+<span class="hljs-built_in">this</span>.getClass().getSimpleName()+<span class="hljs-string">&quot;访问&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteVisitor2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Visitor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visitConcreteElementA</span><span class="hljs-params">(ConcreteElementA concreteElementA)</span> &#123;<br>        System.out.println(concreteElementA.getClass().getSimpleName()+<span class="hljs-string">&quot;被&quot;</span>+<span class="hljs-built_in">this</span>.getClass().getSimpleName()+<span class="hljs-string">&quot;访问&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">visitConcreteElementB</span><span class="hljs-params">(ConcreteElementB concreteElementB)</span> &#123;<br>        System.out.println(concreteElementB.getClass().getSimpleName()+<span class="hljs-string">&quot;被&quot;</span>+<span class="hljs-built_in">this</span>.getClass().getSimpleName()+<span class="hljs-string">&quot;访问&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Element</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Visitor visitor)</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteElementA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Element</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Visitor visitor)</span> &#123;<br>        visitor.visitConcreteElementA(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operationA</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">// 其他相关操作</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteElementB</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Element</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Visitor visitor)</span> &#123;<br>        visitor.visitConcreteElementB(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">operationA</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">// 其他相关操作</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectStructure</span>&#123;<br>    <span class="hljs-keyword">private</span> ArrayList&lt;Element&gt; elements = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Element&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attach</span><span class="hljs-params">(Element element)</span>&#123;<br>        elements.add(element);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detach</span><span class="hljs-params">(Element element)</span>&#123;<br>        elements.remove(element);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Visitor visitor)</span>&#123;<br>        <span class="hljs-keyword">for</span> (Element element : elements) &#123;<br>            element.accept(visitor);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>访问者模式的目的是要把处理从数据结构分离出来，有比较稳定的数据结构，又有易于变化的算法的话，使用访问者模式就是比较合适的，因为访问者模式使得算法操作的增加变得容易。</p>
<p>访问者模式的优点就是增加新的操作很容易，因为增加新的操作就意味着增加一个新的访问者。</p>
<p>访问者模式将有关的行为集中到一个访问者对象中。</p>

                
              </div>
            
            <hr/>
			
			<!-- 添加打赏模块 -->
			<div class="reward-container">
				 
					<button id="rewardBtn" class="reward-btn">
						 
							❤ 打赏
						  	
					</button>
					<p class="tea">“觉得不错的话，给点打赏吧 ୧(๑•̀⌄•́๑)૭ ”</p>
					<div id="rewardImgContainer" class="reward-img-container">
					<div class="singleImgContainer">
						<img id="wechatImg" class="reward-img" src="/img/wechatpay.jpg" alt="微信二维码">
						<p class="wechatPay">微信支付</p>
					</div>
					<div class="singleImgContainer">
						<img id="alipayImg" class="reward-img" src="/img/alipay.png" alt="支付宝二维码">
						<p class="aliPay">支付宝支付</p>
					</div>
					</div>
				
			</div>
			
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="category-chain-item">学习笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#设计模式</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>大话设计模式</div>
      <div>https://blog.jishuqin.cn/posts/4a5b6c7d/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>顾梦</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年5月20日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2024年8月27日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - 非商业性使用">
                    <i class="iconfont icon-nc"></i>
                  </span>
                </a>
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                    <i class="iconfont icon-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/posts/7b4c3d1e/" title="软考-软件设计师 笔记">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">软考-软件设计师 笔记</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/posts/dcba4321/" title="Docker 配置 redis 集群3主3从">
                        <span class="hidden-mobile">Docker 配置 redis 集群3主3从</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments">
      
  <div id="twikoo"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/twikoo/1.6.8/twikoo.all.min.js', function() {
        var options = Object.assign(
          {"envId":"https://twikoo.gumengyo.top/","region":"ap-shanghai","path":"window.location.pathname"},
          {
            el: '#twikoo',
            path: 'window.location.pathname',
            onCommentLoaded: function() {
              var imgSelector = '#twikoo .tk-content img:not(.tk-owo-emotion)';
              Fluid.plugins.imageCaption(imgSelector);
              Fluid.plugins.fancyBox(imgSelector);
            }
          }
        )
        twikoo.init(options)
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  



  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.events.registerRefreshCallback(function() {
      if ('mermaid' in window) {
        mermaid.init();
      }
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span class="umami--click--Footer-Hexo">Hexo</span></a> <span class="with-love"><img src="https://cdn.gumengyo.top/duck.gif" alt="" height="35" style="display:inline-block;vertical-align:middle" data-loaded="true" class="lozaded"> </span> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span class="umami--click--Footer-Fluid">Fluid</span></a> <div style="font-size: 0.85rem"> <span>本站由</span> <span class="with-love"><img src="https://cdn.gumengyo.top//qiniuyun.png" alt="" height="35" style="display:inline-block;vertical-align:middle" data-loaded="true" class="lozaded"> </span> <span>提供CDN加速/云存储服务</span> </div> <div style="font-size: 0.85rem"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      粤ICP备2024161578号-1
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44050702001273"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/img/police_beian.png" alt="police-icon"/>
          
          <span>粤公网安备44050702001273号</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":true,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    
      <script  src="/js/img-lazyload.js" ></script>
    
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.gumengyo.top/blog/APlayer.min.js"></script>
<script src="//cdn.gumengyo.top/blog/Meting.min.js"></script>
<script src="//cdn.gumengyo.top/blog/wow.min.js"></script>
<script src="//cdn1.tianli0.top/gh/zhheo/Post-Abstract-AI@0.8/tianli_gpt.js"></script>
<script src="/js/wow_init.js"></script>
<script src="/js/reward.js"></script>
<script src="/js/loading.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script>
  <link defer rel="stylesheet" href="/styles/backgroundize.css" />

  <!-- 
    <script 
	async 
	defer
	src="http://cdn.jishuqin.cn/blog/random-string.js" 
	data-website-id="bb749527-20c3-43b4-86bf-38105b1ebfc6"
	data-host-url="http://47.115.210.241:3000"
	data-domains="http://blog.jishuqin.cn/"
	>
    </script>
  -->

  
  <script data-pjax src="https://cdn.gumengyo.top/blog/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://gitcalendar.gumengyo.top/api/githubcalendar/api?gumengyo";
            var git_color =['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'];
            var git_user ="gumengyo";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/blog/about/'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --></body>
</html>
